var sam=sam||{};(function(n){var t,i=samEditorOptions.media;sam.media=t={buttonId:"#banner-media",adUrl:"#ad_img",adImgId:"#ad_img_id",adName:"#title",adDesc:"#item_description",adAlt:"#ad_alt",init:function(){n(this.buttonId).on("click",this.openMediaDialog)},openMediaDialog:function(n){if(n.preventDefault(),this._frame){this._frame.open();return}var r=wp.media.model.Attachment;this._frame=t.frame=wp.media({title:i.title,button:{text:i.button},multiple:!1,library:{type:"image"}});this._frame.on("ready",function(){});this._frame.state("library").on("select",function(){var n=this.get("selection").single();t.handleMediaAttachment(n)});this._frame.open()},handleMediaAttachment:function(t){var i=t.toJSON();n(this.adUrl).val(i.url);n(this.adImgId).val(i.id);""==n(this.adName).val()&&""!=i.title&&n(this.adName).val(i.title);""==n(this.adDesc).val()&&""!=i.caption&&n(this.adDesc).val(i.caption);""==n(this.adAlt).val()&&""!=i.alt&&n(this.adAlt).val(i.alt)}};n(document).ready(function(){function sr(t,i,r,u,f,e){var o=r.val();i.w2grid({name:t,show:{selectColumn:!0},multiSelect:!0,columns:f,url:e,onSelect:function(n){n.onComplete=function(){for(var f,e="",t=this.getSelection(),i,n=0;n<t.length;n++)f=this.get(t[n]),i=u=="id"?f.id:f.slug,e+=n==t.length-1?i:i+",";r.val(e)}},onUnselect:function(n){n.onComplete=function(){for(var f,e="",t=this.getSelection(),i,n=0;n<t.length;n++)f=this.get(t[n]),i=u=="id"?f.id:f.slug,e+=n==t.length-1?i:i+",";r.val(e)}},onLoad:function(i){i.onComplete=function(){if(null!=o&&""!=o){var i=o.split(",");n.each(i,function(i,r){n.each(w2ui[t].records,function(n,i){var f=u=="id"?i.id:i.slug;return f==r?(w2ui[t].select(i.recid),!1):!0})})}}}})}function f(t,i,r,u,f,e){var o=r.val(),s;i.w2grid({name:t,show:{selectColumn:!0},multiSelect:!0,columns:f,records:e,onSelect:function(n){n.onComplete=function(){for(var f,e="",t=this.getSelection(),i,n=0;n<t.length;n++)f=this.get(t[n]),i=u=="id"?f.id:f.slug,e+=n==t.length-1?i:i+",";r.val(e)}},onUnselect:function(n){n.onComplete=function(){for(var f,e="",t=this.getSelection(),i,n=0;n<t.length;n++)f=this.get(t[n]),i=u=="id"?f.id:f.slug,e+=n==t.length-1?i:i+",";r.val(e)}}});null!=o&&""!=o&&(s=o.split(","),n.each(s,function(i,r){n.each(e,function(n,i){var f=u=="id"?i.id:i.slug;return f==r?(w2ui[t].select(i.recid),!1):!0})}))}var gi=n("#editor_mode").val(),uu,bt=n("#title"),e=n("#rc-vt0"),o=n("#rc-vt2"),u=n("#x_id"),b=n("#rc-xid"),k=n("#ad_cats"),ct=n("#rc-ac"),kt=n("#acw"),s=n("#x_cats"),d=n("#rc-xc"),g=n("#ad_custom_tax_terms"),lt=n("#rc-ctt"),dt=n("#cttw"),h=n("#x_ad_custom_tax_terms"),nt=n("#rc-xct"),tt=n("#ad_authors"),at=n("#rc-au"),gt=n("#aaw"),c=n("#x_authors"),it=n("#rc-xa"),rt=n("#ad_tags"),vt=n("#rc-at"),ni=n("#atw"),l=n("#x_tags"),ut=n("#rc-xt"),ft=n("#ad_custom"),yt=n("#rc-cu"),ti=n("#cuw"),a=n("#x_custom"),et=n("#rc-xu"),ot=n("#x-view-users"),pt=n("#custom-users"),nr=n("#rc-cmf"),tr=n("#rc-cmt"),ir=n("#ad_users_reg"),rr=n("#x-reg-users"),ur=n("#x_ad_users"),fu=n("#upload-file-button"),ii=n("#uploading"),eu=n("#uploading-help"),fr=n("#load_img"),v,ri=n("#ctt-grid"),ou=n("#view_custom_tax_terms"),ui=n("#x-ctt-grid"),su=n("#x_view_custom_tax_terms"),fi=n("#posts-grid"),hu=n("#view_id"),st=n("#users-grid"),cu=n("#x_view_users"),ei=n("#x-posts-grid"),lu=n("#x_view_id"),oi=n("#cats-grid"),au=n("#view_cats"),si=n("#x-cats-grid"),vu=n("#x_view_cats"),hi=n("#auth-grid"),yu=n("#view_authors"),ci=n("#x-auth-grid"),pu=n("#x_view_authors"),li=n("#tags-grid"),wu=n("#view_tags"),ai=n("#x-tags-grid"),bu=n("#x_view_tags"),vi=n("#cust-grid"),ku=n("#view_custom"),yi=n("#x-cust-grid"),du=n("#x_view_custom"),y=samEditorOptions.samAjaxUrl,er=samEditorOptions.samStatsUrl,r=samEditorOptions.models,wt=samEditorOptions.data,i=samEditorOptions.strings,gu=encodeURI(i.posts),nf=encodeURI(i.page),tf,ht,or=n("#item_id").val(),pi=0,wi,hr,bi,cr,lr,ar,ki,vr,di;bt.tooltip({track:!0});n("#image_tools").tabs();t.init();tf=n.post(er,{action:"load_item_stats",id:or,sm:pi}).done(function(t){var r={label:i.labels.hits,data:t.hits},u={label:i.labels.clicks,data:t.clicks};ht=[r,u];n("#total_hits").text(t.total.hits);n("#total_clicks").text(t.total.clicks);n.plot("#graph",ht,{series:{lines:{show:!0},points:{show:!0}},xaxis:{mode:"categories",tickLength:0},legend:{backgroundColor:"rgb(235, 233, 233)"},grid:{backgroundColor:{colors:["#FFFFFF","#DDDDDD"]},borderWidth:1,borderColor:"#DFDFDF"}})});uu=new AjaxUpload(fu,{action:ajaxurl,name:"uploadfile",data:{action:"upload_ad_image"},onSubmit:function(n,t){return(t&&/^(jpg|png|jpeg|gif|swf)$/.test(t))?(fr.show(),ii.text(i.uploading),!1):(ii.text(i.status),!1)},onComplete:function(t,r){ii.text("");fr.hide();n('<div id="files"><\/div>').appendTo(eu);r=="success"?(n("#files").text(i.file+" "+t+" "+i.uploaded).addClass("updated").delay(3e3).fadeOut(1e3,function(){n(this).remove()}),gi=="item"?n("#ad_img").val(i.url+t):gi=="place"&&n("#patch_img").val(i.url+t)):n("#files").text(t+" "+r).addClass("error").delay(3e3).fadeOut(1e3,function(){n(this).remove()})}});n("#adv_nick").combogrid({url:y+"?action=load_combo_data",datatype:"json",munit:"px",alternate:!0,colModel:r.comboGrid,select:function(t,i){return n("#adv_nick").val(i.item.slug),n("#adv_name").val(i.item.title),n("#adv_mail").val(i.item.email),!1}});n("#add-file-button").click(function(){var t=i.url+n("select#files_list option:selected").val();return n("#ad_img").val(t),!1});f("ctt-grid",ri,ou,"slug",r.customTaxes,wt.cTax);f("x-ctt-grid",ui,su,"slug",r.customTaxes,wt.cTax);f("cust-grid",vi,ku,"slug",r.customs,wt.customs);f("x-cust-grid",yi,du,"slug",r.customs,wt.customs);wi=y+"?action=load_posts&cstr="+samEditorOptions.data.custList+"&sp="+gu+"&spg="+nf;sr("posts-grid",fi,hu,"id",r.posts,wi);sr("x-posts-grid",ei,lu,"id",r.posts,wi);n("#tabs").tabs({activate:function(t,i){var r=i.newPanel[0].id;r=="tabs-1"&&w2ui["posts-grid"]&&fi.w2render("posts-grid");r=="tabs-2"&&(lt.is(":visible")&&w2ui["ctt-grid"]&&ri.w2render("ctt-grid"),nt.is(":visible")&&w2ui["x-ctt-grid"]&&ui.w2render("x-ctt-grid"),b.is(":visible")&&w2ui["x-posts-grid"]&&ei.w2render("x-posts-grid"),ct.is(":visible")&&w2ui["cats-grid"]&&oi.w2render("cats-grid"),d.is(":visible")&&w2ui["x-cats-grid"]&&si.w2render("x-cats-grid"),at.is(":visible")&&w2ui["auth-grid"]&&hi.w2render("auth-grid"),it.is(":visible")&&w2ui["x-auth-grid"]&&ci.w2render("x-auth-grid"),vt.is(":visible")&&w2ui["tags-grid"]&&li.w2render("tags-grid"),ut.is(":visible")&&w2ui["x-tags-grid"]&&ai.w2render("x-tags-grid"),yt.is(":visible")&&w2ui["cust-grid"]&&vi.w2render("cust-grid"),et.is(":visible")&&w2ui["xcust-grid"]&&yi.w2render("x-cust-grid"));r=="tabs-3"&&ot.is(":visible")&&w2ui["users-grid"]&&st.w2render("users-grid");r=="tabs-5"&&n.plot("#graph",ht,{series:{lines:{show:!0},points:{show:!0}},xaxis:{mode:"categories",tickLength:0},legend:{backgroundColor:"rgb(235, 233, 233)"},grid:{backgroundColor:{colors:["#FFFFFF","#DDDDDD"]},borderWidth:1,borderColor:"#DFDFDF"}})}});n("#code_mode_false").click(function(){nr.show("blind",{direction:"vertical"},500);tr.hide("blind",{direction:"vertical"},500)});n("#code_mode_true").click(function(){nr.hide("blind",{direction:"vertical"},500);tr.show("blind",{direction:"vertical"},500)});2==n("input:radio[name=view_type]:checked").val()&&(u.is(":checked")&&(u.attr("checked",!1),b.hide("blind",{direction:"vertical"},500)),u.attr("disabled",!0));n("input:radio[name=view_type]").click(function(){var t=n("input:radio[name=view_type]:checked").val();switch(t){case"0":e.is(":hidden")&&e.show("blind",{direction:"vertical"},500);o.is(":visible")&&o.hide("blind",{direction:"vertical"},500);u.attr("disabled",!1);break;case"1":e.is(":visible")&&e.hide("blind",{direction:"vertical"},500);o.is(":visible")&&o.hide("blind",{direction:"vertical"},500);u.attr("disabled",!1);break;case"2":e.is(":visible")&&e.hide("blind",{direction:"vertical"},500);o.is(":hidden")&&(o.show("blind",{direction:"vertical"},500,function(){w2ui["posts-grid"]&&fi.w2render("posts-grid")}),u.is(":checked")&&(u.attr("checked",!1),b.hide("blind",{direction:"vertical"},500)));u.attr("disabled",!0)}});hr=n.ajax({url:y,data:{action:"load_authors",level:3},type:"POST"});hr.done(function(n){bi=n;f("auth-grid",hi,yu,"slug",r.authors,bi);f("x-auth-grid",ci,pu,"slug",r.authors,bi)});cr=n.ajax({url:y,data:{action:"load_users",subscriber:encodeURI(i.subscriber),contributor:encodeURI(i.contributor),author:encodeURI(i.author),editor:encodeURI(i.editor),admin:encodeURI(i.admin),sadmin:encodeURI(i.superAdmin)},type:"POST"});cr.done(function(n){lr=n;f("users-grid",st,cu,"slug",r.users,lr)});ar=n.ajax({url:y,data:{action:"load_cats",level:3},type:"POST"});ar.done(function(n){ki=n;f("cats-grid",oi,au,"slug",r.cats,ki);f("x-cats-grid",si,vu,"slug",r.cats,ki)});vr=n.ajax({url:y,data:{action:"load_tags",level:3},type:"POST"});vr.done(function(n){di=n;f("tags-grid",li,wu,"slug",r.tags,di);f("x-tags-grid",ai,bu,"slug",r.tags,di)});u.click(function(){u.is(":checked")?2==n("input:radio[name=view_type]:checked").val()?u.attr("checked",!1):b.show("blind",{direction:"vertical"},500,function(){w2ui["x-posts-grid"]&&ei.w2render("x-posts-grid")}):b.hide("blind",{direction:"vertical"},500)});n("input:radio[name=ad_users]").click(function(){var t=n("input:radio[name=ad_users]:checked").val();t=="0"?pt.is(":visible")&&pt.hide("blind",{direction:"vertical"},500):pt.is(":hidden")&&pt.show("blind",{direction:"vertical"},500,function(){ot.is(":visible")&&w2ui["users-grid"]&&st.w2render("users-grid")})});ir.click(function(){ir.is(":checked")?rr.show("blind",{direction:"vertical"},500,function(){ot.is(":visible")&&w2ui["users-grid"]&&st.w2render("users-grid")}):rr.hide("blind",{direction:"vertical"},500)});ur.click(function(){ur.is(":checked")?ot.show("blind",{direction:"vertical"},500,function(){w2ui["users-grid"]&&st.w2render("users-grid")}):ot.hide("blind",{direction:"vertical"},500)});n("#ad_swf").click(function(){n("#ad_swf").is(":checked")?n("#swf-params").show("blind",{direction:"vertical"},500):n("#swf-params").hide("blind",{direction:"vertical"},500)});k.is(":checked")&&s.is(":checked")&&(s.attr("checked",!1),d.hide("blind",{direction:"vertical"},500));k.click(function(){k.is(":checked")?(ct.show("blind",{direction:"vertical"},500,function(){w2ui["cats-grid"]&&oi.w2render("cats-grid")}),kt.show("blind",{direction:"vertical"},500),s.is(":checked")&&(s.attr("checked",!1),d.hide("blind",{direction:"vertical"},500))):(ct.hide("blind",{direction:"vertical"},500),kt.hide("blind",{direction:"vertical"},500))});s.click(function(){s.is(":checked")?(d.show("blind",{direction:"vertical"},500,function(){w2ui["x-cats-grid"]&&si.w2render("x-cats-grid")}),k.is(":checked")&&(k.attr("checked",!1),ct.hide("blind",{direction:"vertical"},500),kt.hide("blind",{direction:"vertical"},500))):d.hide("blind",{direction:"vertical"},500)});g.is(":checked")&&h.is(":checked")&&(h.attr("checked",!1),nt.hide("blind",{direction:"vertical"},500));g.click(function(){g.is(":checked")?(lt.show("blind",{direction:"vertical"},500,function(){w2ui["ctt-grid"]&&ri.w2render("ctt-grid")}),dt.show("blind",{direction:"vertical"},500),h.is(":checked")&&(h.attr("checked",!1),nt.hide("blind",{direction:"vertical"},500))):(lt.hide("blind",{direction:"vertical"},500),dt.hide("blind",{direction:"vertical"},500))});h.click(function(){h.is(":checked")?(nt.show("blind",{direction:"vertical"},500,function(){w2ui["x-ctt-grid"]&&ui.w2render("x-ctt-grid")}),g.is(":checked")&&(g.attr("checked",!1),lt.hide("blind",{direction:"vertical"},500),dt.hide("blind",{direction:"vertical"},500))):nt.hide("blind",{direction:"vertical"},500)});tt.is(":checked")&&c.is(":checked")&&(c.attr("checked",!1),it.hide("blind",{direction:"vertical"},500));tt.click(function(){tt.is(":checked")?(at.show("blind",{direction:"vertical"},500,function(){w2ui["auth-grid"]&&hi.w2render("auth-grid")}),gt.show("blind",{direction:"vertical"},500),c.is(":checked")&&(c.attr("checked",!1),it.hide("blind",{direction:"vertical"},500))):(at.hide("blind",{direction:"vertical"},500),gt.hide("blind",{direction:"vertical"},500))});c.click(function(){c.is(":checked")?(it.show("blind",{direction:"vertical"},500,function(){w2ui["x-auth-grid"]&&ci.w2render("x-auth-grid")}),tt.is(":checked")&&(tt.attr("checked",!1),at.hide("blind",{direction:"vertical"},500),gt.hide("blind",{direction:"vertical"},500))):it.hide("blind",{direction:"vertical"},500)});rt.is(":checked")&&l.is(":checked")&&(l.attr("checked",!1),ut.hide("blind",{direction:"vertical"},500));rt.click(function(){rt.is(":checked")?(vt.show("blind",{direction:"vertical"},500,function(){w2ui["tags-grid"]&&li.w2render("tags-grid")}),ni.show("blind",{direction:"vertical"},500),l.is(":checked")&&(l.attr("checked",!1),ut.hide("blind",{direction:"vertical"},500))):(vt.hide("blind",{direction:"vertical"},500),ni.hide("blind",{direction:"vertical"},500))});l.click(function(){l.is(":checked")?(ut.show("blind",{direction:"vertical"},500,function(){w2ui["x-tags-grid"]&&ai.w2render("x-tags-grid")}),rt.is(":checked")&&(rt.attr("checked",!1),vt.hide("blind",{direction:"vertical"},500),ni.hide("blind",{direction:"vertical"},500))):ut.hide("blind",{direction:"vertical"},500)});ft.is(":checked")&&a.is(":checked")&&(a.attr("checked",!1),et.hide("blind",{direction:"vertical"},500));ft.click(function(){ft.is(":checked")?(yt.show("blind",{direction:"vertical"},500,function(){w2ui["cust-grid"]&&vi.w2render("cust-grid")}),ti.show("blind",{direction:"vertical"},500),a.is(":checked")&&(a.attr("checked",!1),et.hide("blind",{direction:"vertical"},500))):(yt.hide("blind",{direction:"vertical"},500),ti.hide("blind",{direction:"vertical"},500))});a.click(function(){a.is(":checked")?(et.show("blind",{direction:"vertical"},500,function(){w2ui["x-cust-grid"]&&yi.w2render("x-cust-grid")}),ft.is(":checked")&&(ft.attr("checked",!1),yt.hide("blind",{direction:"vertical"},500),ti.hide("blind",{direction:"vertical"},500))):et.hide("blind",{direction:"vertical"},500)});n("#ad_start_date, #ad_end_date").datepicker({dateFormat:"yy-mm-dd",showButtonPanel:!0});n("#ad_schedule").click(function(){n("#ad_schedule").is(":checked")?n("#rc-sc").show("blind",{direction:"vertical"},500):n("#rc-sc").hide("blind",{direction:"vertical"},500)});n("#limit_hits").click(function(){n("#limit_hits").is(":checked")?n("#rc-hl").show("blind",{direction:"vertical"},500):n("#rc-hl").hide("blind",{direction:"vertical"},500)});n("#limit_clicks").click(function(){n("#limit_clicks").is(":checked")?n("#rc-cl").show("blind",{direction:"vertical"},500):n("#rc-cl").hide("blind",{direction:"vertical"},500)});v=samEditorOptions.ads;v.pointer="ads";(v.enabled||""==bt.val())&&bt.pointer({content:"<h3>"+v.title+"<\/h3><p>"+v.content+"<\/p>",position:"top",close:function(){n.ajax({url:ajaxurl,data:{action:"close_pointer",pointer:v.pointer},async:!0})}}).pointer("open");var p=n("#is_singular"),yr=n("#is_single"),pr=n("#is_page"),wr=n("#is_attachment"),br=n("#is_posttype");p.click(function(){p.is(":checked")&&n("#is_single, #is_page, #is_attachment, #is_posttype").attr("checked",!0)});n("#is_single, #is_page, #is_attachment, #is_posttype").click(function(){!p.is(":checked")||yr.is(":checked")&&pr.is(":checked")&&wr.is(":checked")&&br.is(":checked")?!p.is(":checked")&&yr.is(":checked")&&br.is(":checked")&&pr.is(":checked")&&wr.is(":checked")&&p.attr("checked",!0):p.attr("checked",!1)});var w=n("#is_archive"),kr=n("#is_tax"),dr=n("#is_category"),gr=n("#is_tag"),nu=n("#is_author"),tu=n("#is_date"),iu=n("#is_posttype_archive"),ru=n("#is_tax, #is_category, #is_tag, #is_author, #is_date, #is_posttype_archive");return w.click(function(){w.is(":checked")&&ru.attr("checked",!0)}),ru.click(function(){!w.is(":checked")||kr.is(":checked")&&dr.is(":checked")&&iu.is(":checked")&&gr.is(":checked")&&nu.is(":checked")&&tu.is(":checked")?!w.is(":checked")&&kr.is(":checked")&&dr.is(":checked")&&iu.is(":checked")&&gr.is(":checked")&&nu.is(":checked")&&tu.is(":checked")&&w.attr("checked",!0):w.attr("checked",!1)}),n("#stats_month").change(function(){pi=n(this).val();n.post(er,{action:"load_item_stats",id:or,sm:pi}).done(function(t){var r={label:i.labels.hits,data:t.hits},u={label:i.labels.clicks,data:t.clicks};ht=[r,u];n("#total_hits").text(t.total.hits);n("#total_clicks").text(t.total.clicks);n.plot("#graph",ht,{series:{lines:{show:!0},points:{show:!0}},xaxis:{mode:"categories",tickLength:0},legend:{backgroundColor:"rgb(235, 233, 233)"},grid:{backgroundColor:{colors:["#FFFFFF","#DDDDDD"]},borderWidth:1,borderColor:"#DFDFDF"}})})}),!1})})(jQuery)